##   Kaspersky Container Security — Task Queue

**Автор:** Фамилия Усманов Мукам 
**Язык:** Go 1.24  
**Описание:** Внутренняя очередь для фоновой обработки задач с пулом воркеров, retry и экспоненциальным backoff.

## Запуск

1. Установить Go 1.24.
2. Скачать проект и перейти в папку проекта.
3. Установить зависимости (если нужны):

```bash
        go mod tidy
```

## Запустить сервер:

        go run cmd/main.go



Сервер стартует на http://localhost:8080.

##   Эндпоинты API
1. Добавление задачи

POST /enqueue

Тело JSON:
```

{
    "id": "1",
    "payload": "текст задачи",
    "max_retries": 3
}

```

Ответы:

        200 OK — задача добавлена в очередь

        400 Bad Request — неверный JSON или пустой id/payload

        503 Service Unavailable — очередь полна


2. Проверка состояния сервера

GET /healthz

        200 OK
        OK


3. Просмотр всех задач

GET /tasks

Пример ответа:

```

[
  {
    "id": "1",
    "payload": "тест",
    "max_retries": 3,
    "status": "done",
    "attempts": 1
  },
  {
    "id": "2",
    "payload": "другая задача",
    "max_retries": 2,
    "status": "running",
    "attempts": 0
  }
]


```

Статусы: queued | running | done | failed


##   Особенности реализации

-   Пул воркеров с настраиваемым количеством WORKERS.

-   Буферизированная очередь (QUEUE_SIZE) для входящих задач.

-   Каждая задача «работает» 100–500 мс (симуляция).

-   20% задач падают случайно → используется экспоненциальный backoff с jitter до max_retries.

-   Graceful shutdown: сервер завершает работу корректно при SIGINT/SIGTERM, дожидаясь завершения всех задач.

-   Полностью реализовано на Go 1.24, без сторонних библиотек.
